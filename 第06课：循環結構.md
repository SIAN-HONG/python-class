## 第06課：循環結構

### 應用場景

我們在寫程序的時候，一定會遇到需要重複執行某條指令或某些指令的場景。例如用程序控制機器人踢足球，如果機器人持球而且還沒有進入射門範圍，那麼我們就要一直發出讓機器人向球門方向移動的指令。在這個場景中，讓機器人向球門方向移動就是一個需要重複的動作，當然這裡還會用到上一課講的分支結構來判斷機器人是否持球以及是否進入射門範圍。再舉一個簡單的例子，如果要實現每隔1秒中在屏幕上打印一次“hello, world”並持續打印一個小時，我們肯定不能夠直接把`print('hello, world')`這句代碼寫3600遍，這裡我們需要構造循環結構。

所謂循環結構，就是程序中控制某條或某些指令重複執行的結構。在Python中構造循環結構有兩種做法，一種是`for-in`循環，另一種是`while`循環。

### for-in循環

如果明確的知道循環執行的次數，我們推薦使用`for-in`循環，例如輸出100行的”hello, world“。被`for-in`循環控制的語句塊也是通過縮進的方式來構造的，這一點跟分支結構完全相同，大家看看下面的代碼就明白了。

```Python
"""
用for循環實現1~100求和

Version: 0.1
Author: 駱昊
"""
total = 0
for x in range(1, 101):
    total += x
print(total)
```

需要說明的是上面代碼中的`range(1, 101)`可以用來構造一個從`1`到`100`的範圍，當我們把這樣一個範圍放到`for-in`循環中，就可以通過前面的循環變量`x`依次取出從`1`到`100`的整數。當然，`range`的用法非常靈活，下面給出了一個例子：

- `range(101)`：可以用來產生0到100範圍的整數，需要注意的是取不到101。
- `range(1, 101)`：可以用來產生1到100範圍的整數，相當於前面是閉區間後面是開區間。
- `range(1, 101, 2)`：可以用來產生1到100的奇數，其中2是步長，即每次遞增的值。
- `range(100, 0, -2)`：可以用來產生100到1的偶數，其中-2是步長，即每次遞減的值。

知道了這一點，我們可以用下面的代碼來實現1~100之間的偶數求和。

```Python
"""
用for循環實現1~100之間的偶數求和

Version: 0.1
Author: 駱昊
"""
total = 0
for x in range(2, 101, 2):
    total += x
print(total)
```

### while循環

如果要構造不知道具體循環次數的循環結構，我們推薦使用`while`循環。 `while`循環通過一個能夠產生`bool`值的表達式來控制循環，當表達式的值為`True`時則繼續循環，當表達式的值為`False`時則結束循環。

下面我們通過一個“猜數字”的小遊戲來看看如何使用`while`循環。猜數字遊戲的規則是：計算機出一個`1`到`100`之間的隨機數，玩家輸入自己猜的數字，計算機給出對應的提示信息（大一點、小一點或猜對了），如果玩家猜中了數字，計算機提示用戶一共猜了多少次，遊戲結束，否則遊戲繼續。

```Python
"""
猜數字遊戲

Version: 0.1
Author: 駱昊
"""
import random

# 產生一個1-100範圍的隨機數
answer = random.randint(1, 100)
counter = 0
while True:
    counter += 1
    number = int(input('請輸入: '))
    if number < answer:
        print('大一點')
    elif number > answer:
        print('小一點')
    else:
        print('恭喜你猜對了!')
        break
# 當退出while循環的時候顯示用戶一共猜了多少次
print(f'你總共猜了{counter}次')
```

### break和continue

上面的代碼中使用`while True`構造了一個條件恆成立的循環，也就意味著如果不做特殊處理，循環是不會結束的，這也就是常說的“死循環”。為了在用戶猜中數字時能夠退出循環結構，我們使用了`break`關鍵字，它的作用是提前結束循環。需要注意的是，`break`只能終止它所在的那個循環，這一點在使用嵌套循環結構時需要引起注意，下面的例子我們會講到什麼是嵌套的循環結構。除了`break`之外，還有另一個關鍵字是`continue`，它可以用來放棄本次循環後續的代碼直接讓循環進入下一輪。

### 嵌套的循環結構

和分支結構一樣，循環結構也是可以嵌套的，也就是說在循環中還可以構造循環結構。下面的例子演示瞭如何通過嵌套的循環來輸出一個乘法口訣表（九九表）。

```Python
"""
打印乘法口訣表

Version: 0.1
Author: 駱昊
"""
for i in range(1, 10):
    for j in range(1, i + 1):
        print(f'{i}*{j}={i * j}', end='\t')
    print()
```

很顯然，在上面的代碼中，外層循環用來控制一共會產生`9`行的輸出，而內層循環用來控制每一行會輸出多少列。內層循環中的輸出就是九九表一行中的所有列，所以在內層循環完成時，有一個`print()`來實現換行輸出的效果。

### 循環的例子

#### 例子1：輸入一個正整數判斷它是不是素數。

> **提示**：素數指的是只能被1和自身整除的大於1的整數。

```Python
"""
輸入一個正整數判斷它是不是素數

Version: 0.1
Author: 駱昊
"""
num = int(input('請輸入一個正整數: '))
end = int(num ** 0.5)
is_prime = True
for x in range(2, end + 1):
    if num % x == 0:
        is_prime = False
        break
if is_prime and num != 1:
    print(f'{num}是素數')
else:
    print(f'{num}不是素數')
```

#### 例子2：輸入兩個正整數，計算它們的最大公約數和最小公倍數。

> **提示**：兩個數的最大公約數是兩個數的公共因子中最大的那個數；兩個數的最小公倍數則是能夠同時被兩個數整除的最小的那個數。

```Python
"""
輸入兩個正整數計算它們的最大公約數和最小公倍數

Version: 0.1
Author: 駱昊
"""

x = int(input('x = '))
y = int(input('y = '))
for factor in range(x, 0, -1):
    if x % factor == 0 and y % factor == 0:
        print(f'{x}和{y}的最大公約數是{factor}')
        print(f'{x}和{y}的最小公倍數是{x * y // factor}')
        break
```

### 簡單的總結

學會了Python中的分支結構和循環結構，我們就可以解決很多實際的問題了。通過這節課的學習，大家應該已經知道了可以用`for`和`while`關鍵字來構造循環結構。 **如果知道循環的次數，我們通常使用**`for`**循環**；如果**循環次數不能確定，可以用**`while`**循環**。在循環中還**可以使用**`break`**來提前結束循環**。
